<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1"/>
<link rel="shortcut icon" href="/assets/favicon.png"/>
<link rel="stylesheet" href="/assets/fonts/fonts.css"/>

<!-- ....................................................................... -->
<link rel="stylesheet" href="/gs-ui-components/gsui.css"/>
<link rel="stylesheet" href="/gs-ui-components/test-assets/test.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiIcon/gsuiIcon.css"/>

<!-- ....................................................................... -->
<link rel="stylesheet" href="/gs-ui-components/gsuiDragshield/gsuiDragshield.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiScrollShadow/gsuiScrollShadow.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiBeatlines/gsuiBeatlines.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiSlider/gsuiSlider.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiToggle/gsuiToggle.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiDrumrows/gsuiDrumrows.colors.default.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiDrumrows/gsuiDrumrows.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiTimeline/gsuiTimeline.colors.default.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiTimeline/gsuiTimeline.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiTimewindow/gsuiTimewindow.colors.default.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiTimewindow/gsuiTimewindow.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiSliderGroup/gsuiSliderGroup.colors.default.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiSliderGroup/gsuiSliderGroup.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiDrum/gsuiDrum.css"/>

<!-- ....................................................................... -->
<link rel="stylesheet" href="/gs-ui-components/gsuiDrums/gsuiDrums.colors.default.css"/>
<link rel="stylesheet" href="/gs-ui-components/gsuiDrums/gsuiDrums.css"/>

<!-- ....................................................................... -->
<style>
body {
	--test-content-w: 600px;
	--test-content-h: 400px;
	--test-content-resize: both;
}
</style>
</head>
<body>

<!-- ....................................................................... -->
<div id="TEST">
	<gsui-drums timedivision="4/4"></gsui-drums>
</div>

<!-- ....................................................................... -->
<script src="/gs-ui-components/gsui.js"></script>
<script src="/gs-ui-components/test-assets/test.js"></script>

<!-- ....................................................................... -->
<script src="/gs-ui-components/gsuiReorder/gsuiReorder.js"></script>
<script src="/gs-ui-components/gsuiDragshield/gsuiDragshield.js"></script>
<script src="/gs-ui-components/gsuiScrollShadow/gsuiScrollShadow.js"></script>
<script src="/gs-ui-components/gsuiBeatlines/gsuiBeatlines.html.js"></script>
<script src="/gs-ui-components/gsuiBeatlines/gsuiBeatlines.js"></script>
<script src="/gs-ui-components/gsuiSlider/gsuiSlider.html.js"></script>
<script src="/gs-ui-components/gsuiSlider/gsuiSlider.js"></script>
<script src="/gs-ui-components/gsuiToggle/gsuiToggle.js"></script>
<script src="/gs-ui-components/gsuiSVGPatterns/gsuiSVGPatterns.js"></script>
<script src="/gs-ui-components/gsuiWaveform/gsuiWaveform.js"></script>
<script src="/gs-ui-components/gsuiDrumrows/gsuiDrumrows.html.js"></script>
<script src="/gs-ui-components/gsuiDrumrows/gsuiDrumrows.js"></script>
<script src="/gs-ui-components/gsuiTimeline/gsuiTimeline.html.js"></script>
<script src="/gs-ui-components/gsuiTimeline/gsuiTimeline.js"></script>
<script src="/gs-ui-components/gsuiTimewindow/gsuiTimewindow.html.js"></script>
<script src="/gs-ui-components/gsuiTimewindow/gsuiTimewindow.js"></script>
<script src="/gs-ui-components/gsuiSliderGroup/gsuiSliderGroup.html.js"></script>
<script src="/gs-ui-components/gsuiSliderGroup/gsuiSliderGroup.js"></script>
<script src="/gs-ui-components/gsuiDrum/gsuiDrum.html.js"></script>
<script src="/gs-ui-components/gsuiDrum/gsuiDrum.js"></script>
<script src="/gs-ui-components/gsuiDrum/gsuiDrumcut.js"></script>

<!-- ....................................................................... -->
<script src="/gs-ui-components/gsuiDrums/gsuiDrums.html.js"></script>
<script src="/gs-ui-components/gsuiDrums/gsuiDrums.js"></script>

<!-- ....................................................................... -->
<script>
const drums = document.querySelector( "gsui-drums" );
const ctx = new AudioContext();

initRow( "dr0", "kick 017", 0, 0, 1, "kick-017" );
initRow( "dr1", "clap 013", 0, .2, .7, "clap-013" );
initRow( "dr2", "hat 024", 0, .2, .7, "hat-024" );
initRow( "dr3", "openhat 012", .2, -.5, .6, "openhat-012" );
initRow( "dr4", "snare 018", 0, 0, .5, "snare-018" );

drums.addDrum( "d00", { row: "dr0", when: .00 } );
drums.addDrum( "d01", { row: "dr0", when: .25 } );
drums.addDrum( "d02", { row: "dr0", when: .50 } );
drums.addDrum( "d04", { row: "dr0", when: .75 } );
drums.addDrum( "d05", { row: "dr0", when: 1 } );
drums.changeDrum( "d00", "gain", .5 );
drums.addDrumcut( "dc00", { row: "dr0", when: 1 } );

drums.addDrum( "d10", { row: "dr1", when: 1.00 } );
drums.addDrum( "d11", { row: "dr1", when: 1.25 } );
drums.addDrum( "d12", { row: "dr1", when: 1.50 } );
drums.addDrum( "d13", { row: "dr1", when: 1.75 } );
drums.addDrum( "d14", { row: "dr1", when: 2 } );
drums.changeDrum( "d10", "gain", .5 );
drums.addDrumcut( "dc10", { row: "dr1", when: 2 } );

drums.addDrum( "d30", { row: "dr3", when: 2 } );

drums.addDrum( "d21", { row: "dr2", when: 2 } );
drums.addDrum( "d31", { row: "dr3", when: 2.125 } );
drums.addDrum( "d41", { row: "dr4", when: 2.1875 } );

drums.addDrum( "d34", { row: "dr3", when: 3 } );
// drums.addDrum( "d32", { row: "dr3", when: 3.0625 } );
drums.addDrum( "d33", { row: "dr3", when: 3.125 } );

drums.addDrum( "d42", { row: "dr4", when: 3.0625 } );
drums.addDrum( "d43", { row: "dr4", when: 3.125 } );
drums.addDrum( "d44", { row: "dr4", when: 3 } );

drums.addDrum( "d15", { row: "dr1", when: 3 } );
drums.addDrum( "d16", { row: "dr1", when: 3.125 } );
drums.addDrum( "d17", { row: "dr1", when: 3.1875 } );
drums.addDrum( "d22", { row: "dr2", when: 3 } );
drums.addDrum( "d23", { row: "dr2", when: 3.125 } );
drums.removeDrum( "d16" );
drums.removeDrum( "d17" );
drums.removeDrum( "d23" );

function initRow( drumId, name, detune, pan, gain, bufName ) {
	drums.$addDrumrow( drumId );
	drums.$changeDrumrow( drumId, "name", name );
	drums.$changeDrumrow( drumId, "detune", detune );
	drums.$changeDrumrow( drumId, "pan", pan );
	drums.$changeDrumrow( drumId, "gain", gain );
	fetch( `../test-assets/${ bufName }.wav` )
		.then( res => res.arrayBuffer() )
		.then( arr => ctx.decodeAudioData( arr ) )
		.then( buf => {
			gsuiSVGPatterns.$add( "buffer", bufName );
			gsuiSVGPatterns.$add( "bufferHD", bufName );
			gsuiSVGPatterns.$update( "buffer", bufName, buf );
			drums.$changeDrumrow( drumId, "pattern", gsuiSVGPatterns.$createSVG( "bufferHD", bufName ) );
		} );
}
</script>
</body>
</html>
